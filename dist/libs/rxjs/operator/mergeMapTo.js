"use strict";function mergeMapTo(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"number"==typeof e&&(r=e,e=null),this.lift(new MergeMapToOperator(t,e,r))}var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},OuterSubscriber_1=require("../OuterSubscriber"),subscribeToResult_1=require("../util/subscribeToResult");exports.mergeMapTo=mergeMapTo;var MergeMapToOperator=function(){function t(t,e,r){void 0===r&&(r=Number.POSITIVE_INFINITY),this.ish=t,this.resultSelector=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new MergeMapToSubscriber(t,this.ish,this.resultSelector,this.concurrent))},t}();exports.MergeMapToOperator=MergeMapToOperator;var MergeMapToSubscriber=function(t){function e(e,r,i,s){void 0===s&&(s=Number.POSITIVE_INFINITY),t.call(this,e),this.ish=r,this.resultSelector=i,this.concurrent=s,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return __extends(e,t),e.prototype._next=function(t){if(this.active<this.concurrent){var e=this.resultSelector,r=this.index++,i=this.ish,s=this.destination;this.active++,this._innerSub(i,s,e,t,r)}else this.buffer.push(t)},e.prototype._innerSub=function(t,e,r,i,s){this.add(subscribeToResult_1.subscribeToResult(this,t,i,s))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,i,s){var o=this,n=o.resultSelector,u=o.destination;n?this.trySelectResult(t,e,r,i):u.next(e)},e.prototype.trySelectResult=function(t,e,r,i){var s,o=this,n=o.resultSelector,u=o.destination;try{s=n(t,e,r,i)}catch(t){return void u.error(t)}u.next(s)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber);exports.MergeMapToSubscriber=MergeMapToSubscriber;